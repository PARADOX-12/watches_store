<style>
    .shopify-section{
        width: auto;
        height: auto;
    }

     .slide_show{
        width: 100%;
        height: 100;
    } 

    #slideshow-{{ section.id }} {
    position: relative;
    width: 100%;
    height: 100%;
  }

   .slides-wrapper {
    position: relative;
    width: 100%;
  } 

   .slide {
    position: absolute;
    width: 100%;
    display: none;
  }

  .slide.displayslide {
    display: block;
  }
  
  /* Arrows */
  .arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255,255,255,0.4);
    border: none;
    font-size: 32px;
    padding: 12px 18px;
    cursor: pointer;
    border-radius: 50%;
    z-index: 10;
  }

  .arrow.prev { left: 15px; }
  .arrow.next { right: 15px; }

  .arrow:hover {
    background: rgba(255,255,255,0.7);
  }
</style>

<div class="slide_show">
<section id="slideshow-{{ section.id }}" class="custom-slideshow">
  <div class="slides-wrapper">
    {% for block in section.blocks %}
      <a
        class="slide"
        href="{% if block.settings.collection %}{{ block.settings.collection.url }}{% else %}#{% endif %}"
        {{ block.shopify_attributes }}
      >
        {% assign img_width = 400 %}
        {% assign img_height = 300 %}
        <!-- Calculate height based on aspect ratio (e.g., 4:3) -->
        <img
          src="{{ image | img_url: '400x' }}"
          width="{{ img_width }}"
          height="{{ img_height }}"
          alt="{{ image.alt }}"
          style="max-width: 100%; height: auto;"
        >
      </a>
    {% endfor %}

    <button class="arrow prev" onclick="prevSlide_{{ section.id }}()">&#10094;</button>
    <button class="arrow next" onclick="nextSlide_{{ section.id }}()">&#10095;</button>
  </div>
</section>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
    let slideIndex = 0;
    const slides = document.querySelectorAll("#slideshow-{{ section.id }} .slide");

    if (slides.length === 0) return;

    function showSlide(n) {
      slideIndex = (n + slides.length) % slides.length;

      slides.forEach(slide => slide.classList.remove("displayslide"));
      slides[slideIndex].classList.add("displayslide");
    }

    function nextSlide() {
      showSlide(slideIndex + 1);
    }

    function prevSlide() {
      showSlide(slideIndex - 1);
    }

    window.nextSlide_{{ section.id }} = nextSlide;
    window.prevSlide_{{ section.id }} = prevSlide;

    showSlide(0);

    setInterval(nextSlide, 4000);
  });
</script>

{% schema %}
{
  "name": "Custom Slideshow",
  "max_blocks": 10,
  "settings": [],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Slide image" },
        { "type": "text", "id": "alt", "label": "Alt text" },
        { "type": "collection", "id": "collection", "label": "Link to collection" }
      ]
    }
  ],
  "presets": [{ "name": "Custom Slideshow" }]
}
{% endschema %}
